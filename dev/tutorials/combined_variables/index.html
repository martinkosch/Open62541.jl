<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Adding and reading/writing variables · Open62541.jl</title><meta name="title" content="Adding and reading/writing variables · Open62541.jl"/><meta property="og:title" content="Adding and reading/writing variables · Open62541.jl"/><meta property="twitter:title" content="Adding and reading/writing variables · Open62541.jl"/><meta name="description" content="Documentation for Open62541.jl."/><meta property="og:description" content="Documentation for Open62541.jl."/><meta property="twitter:description" content="Documentation for Open62541.jl."/><meta property="og:url" content="https://martinkosch.github.io/Open62541.jl/tutorials/combined_variables/"/><meta property="twitter:url" content="https://martinkosch.github.io/Open62541.jl/tutorials/combined_variables/"/><link rel="canonical" href="https://martinkosch.github.io/Open62541.jl/tutorials/combined_variables/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Open62541.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../server_first_steps/">First steps: Server</a></li><li><a class="tocitem" href="../client_first_steps/">First steps: Client</a></li><li class="is-active"><a class="tocitem" href>Adding and reading/writing variables</a><ul class="internal"><li><a class="tocitem" href="#Configuring-the-server"><span>Configuring the server</span></a></li><li><a class="tocitem" href="#Using-the-client"><span>Using the client</span></a></li></ul></li><li><a class="tocitem" href="../combined_username_password_login/">Username/password authentication using basic access control</a></li><li><a class="tocitem" href="../combined_encrypted_un_pw_login/">Encrypted username/password authentication using basic access control</a></li><li><a class="tocitem" href="../further_resources/">Further resources</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/numbertypes/">Supported number types</a></li><li><a class="tocitem" href="../../manual/nodeid/">Nodeid</a></li><li><a class="tocitem" href="../../manual/attributegeneration/">Attribute generation</a></li><li><a class="tocitem" href="../../manual/server/">Server</a></li><li><a class="tocitem" href="../../manual/client/">Client</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference_lowlevel/">Low level interface</a></li><li><a class="tocitem" href="../../reference_highlevel/">High level interface</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Adding and reading/writing variables</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Adding and reading/writing variables</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/martinkosch/Open62541.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/martinkosch/Open62541.jl/blob/main/docs/src/tutorials/combined_variables.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Adding-and-reading/writing-variables"><a class="docs-heading-anchor" href="#Adding-and-reading/writing-variables">Adding and reading/writing variables</a><a id="Adding-and-reading/writing-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-and-reading/writing-variables" title="Permalink"></a></h1><p>In this tutorial, we will add three variables to an open62541 server. The first  variable will contain a floating point number, the second an array of floating  point numbers and the third will be an array of two strings.</p><h2 id="Configuring-the-server"><a class="docs-heading-anchor" href="#Configuring-the-server">Configuring the server</a><a id="Configuring-the-server-1"></a><a class="docs-heading-anchor-permalink" href="#Configuring-the-server" title="Permalink"></a></h2><p>This will detail how to add the variables mentioned above to the server. The  code block is commented line by line.</p><pre><code class="language-julia hljs">using Open62541

#configure the open62541 server; we choose a default config on port 4840.
server = JUA_Server()
config = JUA_ServerConfig(server)
JUA_ServerConfig_setDefault(config)

#Define NodeIds that will contain the variables we are adding later. We define 
#NodeIds with nameSpaceIndex = 1 and string identifiers
name1 = &quot;scalar float&quot;
name2 = &quot;array of floats&quot;
name3 = &quot;array of strings&quot;
id1 = JUA_NodeId(1, name1)
id2 = JUA_NodeId(1, name2)
id3 = JUA_NodeId(1, name3)

#Now define variable attributes

accesslevel = UA_ACCESSLEVEL(read = true, write = true) #allows clients to read/write the value of a variable
writemask = UA_WRITEMASK(arraydimensions = true) #allows clients to change the array dimensions of a variable

attr1 = JUA_VariableAttributes(value = 42.0,
    displayname = name1,
    description = &quot;this is a $name1 variable&quot;,
    accesslevel = accesslevel)
attr2 = JUA_VariableAttributes(value = [42.0, 80.0],
    displayname = name2,
    description = &quot;this is a $name2 variable&quot;,
    accesslevel = accesslevel, writemask = writemask)

attr3 = JUA_VariableAttributes(value = [&quot;Maria&quot;, &quot;Peter&quot;],
    displayname = name3,
    description = &quot;this is a $name3 variable&quot;,
    accesslevel = accesslevel)

#Define parent nodes, references, typedefinitions, etc. (same for all three variables)
parentnodeid = JUA_NodeId(0, UA_NS0ID_OBJECTSFOLDER)
parentreferencenodeid = JUA_NodeId(0, UA_NS0ID_ORGANIZES)
typedefinition = JUA_NodeId(0, UA_NS0ID_BASEDATAVARIABLETYPE)
nodecontext = JUA_NodeId()
outnewnodeid = JUA_NodeId()

#Define browsenames for the three variables:
browsename1 = JUA_QualifiedName(1, name1)
browsename2 = JUA_QualifiedName(1, name2)
browsename3 = JUA_QualifiedName(1, name3)

#Add the variables to the server
retval1 = JUA_Server_addNode(server, id1, parentnodeid,
    parentreferencenodeid, browsename1, attr1, nodecontext, outnewnodeid, 
    typedefinition)

retval2 = JUA_Server_addNode(server, id2, parentnodeid,
    parentreferencenodeid, browsename2, attr2, nodecontext, outnewnodeid, 
    typedefinition)

retval3 = JUA_Server_addNode(server, id3, parentnodeid,
    parentreferencenodeid, browsename3, attr3, nodecontext, outnewnodeid, 
    typedefinition)

#retval1-3 should all be UA_STATUSCODE_GOOD (== 0)

#start up the server - interrupt server by pressing CTRL + C multiple times when 
#you are done.
JUA_Server_runUntilInterrupt(server)</code></pre><h2 id="Using-the-client"><a class="docs-heading-anchor" href="#Using-the-client">Using the client</a><a id="Using-the-client-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-client" title="Permalink"></a></h2><p>Start a new Julia session and run the program shown below. Once you are finished,  you may want to return to the first Julia session and stop the server (press  CTRL + C repeatedly).</p><pre><code class="language-julia hljs">using Open62541

#initiate client, configure it and connect to server
client = JUA_Client()
config = JUA_ClientConfig(client)
JUA_ClientConfig_setDefault(config)
JUA_Client_connect(client, &quot;opc.tcp://localhost:4840&quot;)

#create the relevant nodeids (note that we are in a new Julia session, therefore,
#we have to redefine these variables)
name1 = &quot;scalar float&quot;
name2 = &quot;array of floats&quot;
name3 = &quot;array of strings&quot;
id1 = JUA_NodeId(1, name1)
id2 = JUA_NodeId(1, name2)
id3 = JUA_NodeId(1, name3)

#read values from the nodeids specified above
value_id1 = JUA_Client_readValueAttribute(client, id1)
value_id2 = JUA_Client_readValueAttribute(client, id2)
value_id3 = JUA_Client_readValueAttribute(client, id3)

#now write something new into the variables
new1 = 43.0
new2 = [1.0, 2.0, 3.0]
new3 = [&quot;Maria&quot;, &quot;Wuffi&quot;]
retval1 = JUA_Client_writeValueAttribute(client, id1, new1)
retval2 = JUA_Client_writeValueAttribute(client, id2, new2)
retval3 = JUA_Client_writeValueAttribute(client, id3, new3)</code></pre><p>Inspecting the return values (<code>retval1,2,3</code>) and the log and error messages in the  terminal (both server and client), you will see that writing <code>new2</code> to <code>id2</code>  failed with the statuscode &quot;BadTypeMismatch&quot; (<code>retval2</code>). </p><p>This is because in open62541 arrays are statically sized, both in terms of the  number of dimensions, as well as the number of elements along each dimension.  In order for this to work, one first has to specify the new array dimensions  (and the write mask property of the variable has to allow altering this value;  see the server code above!).</p><pre><code class="language-julia hljs">#Try again, but properly this time
retval4 = UA_Client_writeArrayDimensionsAttribute(client, id2, 1, [3])
retval5 = JUA_Client_writeValueAttribute(client, id2, new2)

#disconnect the client (good housekeeping practice)
JUA_Client_disconnect(client)</code></pre><p>Note that changing the dimensionality of the array <strong>additionally</strong> requires  setting the <code>valuerank</code> attribute either to <code>UA_VALUERANK_ONE_OR_MORE_DIMENSIONS</code>  when defining the variable attributes in the server setup code above, or, one  can use <code>UA_Client_writeValueRankAttribute</code> (and the writemask of the variable   attributes has to allow changing the valuerank property) to first change the   valuerank of the variable, before proceeding to change the array dimensions and   then finally setting the variable.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../client_first_steps/">« First steps: Client</a><a class="docs-footer-nextpage" href="../combined_username_password_login/">Username/password authentication using basic access control »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 18 November 2024 22:21">Monday 18 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
